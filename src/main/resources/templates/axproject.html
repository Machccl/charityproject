<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="_fragment :: head(~{::title})">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${project.title}">爱心项目</title>
    <link rel="stylesheet" href="../static/css/bootstrap.css" >
    <link rel="stylesheet" href="../static/lib/editor/css/editormd.min.css">
    <script src="../static/js/jquery-3.1.1.min.js"></script>
    <script src="../static/js/bootstrap.js"></script>
    <script src="../static/lib/editor/editormd.min.js"></script>

    <script src="../static/lib/editor/lib/jquery.flowchart.min.js"></script>
    <script src="../static/lib/editor/lib/flowchart.min.js"></script>
    <script src="../static/lib/editor/lib/marked.min.js"></script>
    <script src="../static/lib/editor/lib/prettify.min.js"></script>
    <script src="../static/lib/editor/lib/raphael.min.js"></script>
    <script src="../static/lib/editor/lib/sequence-diagram.min.js"></script>
    <script src="../static/lib/editor/lib/underscore.min.js"></script>
    

</head>
<body>
    <nav th:replace="_fragment :: nav" class="navbar navbar-inverse" id="mynav">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">Brand</a>
                <button class="navbar-toggle collapsed" data-toggle="collapse" data-target="#mynavbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>    
            </div>
            <div id="mynavbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="./index.html">首页</a></li>
                    <li><a href="./axlist.html">爱心项目</a></li>
                    <li><a href="./artlist.html">资讯</a></li>
                    <li><a href="./videolist.html">公益短片</a></li>
                    <li><a href="./yfdj.html">以废代捐</a></li> 
                    <li><a href="./user/personal.html">个人中心</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><p class="navbar-text text-success"><a href="./user/personal.html">zhangsan</a></p></li>
                    <li><a href="#">退出</a></li>
                </ul>               
            </div>
        </div>
    </nav>

    <div class="container" style="margin-top: 50px;">
        <div class="row">
            <div class="col-md-8">
                <h2 th:text="${project.title}" class="page-header">流浪动物绝育行动</h2>
                <p><span th:text="${project.createtime}" class="glyphicon glyphicon-list-alt">2020-09-20</span></p>
                <div id="test-editormd"  >
                    <textarea th:text="${project.content}" style="display: none" name="test-editormd-markdown-doc">
“二十天，一群人，我们改变了一只狗的命运！”

一只德牧妹妹，在满是垃圾、只有四堵墙的拆迁楼里待了一年多。她每天的生活就是向窗外探出头，盼望好心人的投喂，以及傻傻地等待那个早已遗弃她的主人。

武汉市小动物保护协会（以下简称武小协或协会）对她展开了救援。远远地看上去，她似乎很亲人，体格庞大的她看起来威风凛凛，但近距离接触时，才发现她眼神里流露出的恐惧和担忧。

这是一只很渴望被亲近，却又因太久没有接触外界，而显得有些怯生生的狗狗。

检查身体、绝育……德牧的身体状况恢复到了正常水平。为了感谢武汉市第八人民医院医务人员的照顾，武小协给这只德牧取名为“八妹”。

![](https://images-w.oola.cn/oola-web/imgs/20200810/20200810152833092zFp.png)

近日，有部队的兵哥哥联系到武小协，希望能领养八妹。为她准备了两箱“嫁妆”后，协会的工作人员将绳子和陪伴八妹的使命，一同交到了兵哥哥的手里。

自2006年开始，武小协（前身为武汉流浪宠物救助站）一直坚持动物保护工作，呼吁领养代替购买，用爱终止流浪。

这不是他们第一次进入大众视野。

早在疫情封城期间，武小协就因发起宠物上门救助的志愿活动引发关注，武小协的工作人员及其他志愿者们在新冠肺炎肆虐武汉之际勇敢逆行，帮助暂时无法返汉的家庭上门投喂猫狗。

![](https://images-w.oola.cn/oola-web/imgs/20200810/20200810152841264bkR.png)

这样的公益行动因地因时制宜，也因其新冠肺炎的背景而变得特殊和意义非凡。

小噢对话武小协协会会长杜帆，和他聊了聊置身于其中的经历和心得。
                    </textarea>
                </div>
            </div>

            <div class="row col-md-4" style="margin-top: 200px;">
                <div class="panel">
                    <div class="panel-heading">
                        <div class="panel-title">
                            <h4>推荐</h4>
                        </div>
                    </div>
                    <div class="panel-body">

                        <div th:each="item:${items}" class="media">
                            <div class="media-left">
                                <div class="media-object">
                                    <img th:src="${item.imgurl}" src="../static/image/pro/1.jpg" width="70px">
                                </div>
                            </div>
                            <div class="media-body">
                                <div class="media-heading">
                                    <p><a th:href="@{/project(id=${item.id})}" th:text="${item.title}">为乡村孩子提供美术物资和美术课程，培养和保护孩子的艺术能力。</a></p>
                            </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            
        </div>

        <div class="row" style="margin-top: 15px;">
            <div class="col-md-8">
                <h3>已筹集金额<span id="now" th:text="${project.now}" class="text-success">10000</span>   目标金额<span id="total" th:text="${project.total}" class="text-danger">20000</span></h3>
                <div class="progress">
                    <div class="progress-bar progress-bar-warning" th:text="${progress}" th:style="'width:'+${progress}" style="width: 50%;">50%</div>
                </div>

                <button th:if="${!fish}" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#mymodal">支持项目</button>
                <button th:if="${fish}" disabled class="btn btn-primary btn-lg" data-toggle="modal" data-target="#mymodal">支持项目</button>

                <div id="mymodal" class="modal fade">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <span class="close" data-dismiss="modal">&times;</span>
                                <h3 class="modal-title">项目捐赠</h3>
                            </div>
                            <div class="modal-body">
                                <form id="form-endow" method="post" th:action="@{/user/endow}">
                                    <input id="no" style="display: none" name="out_trade_no">
                                    <input id="subject" th:value="${project.title}" style="display: none" name="subject">
                                    <div class="form-group">
                                        <label class="control-label">金额：</label> 
                                        <input id="amount" name="total_amount" type="text" class="form-control">
                                    </div>
                                    <input id="body" th:value="${project.title}" style="display: none" name="body">
                                    <div class="form-group">
                                        <input id="endow"  type="button" value="确认" class="btn btn-primary">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>

            </div>           
        </div>
    </div>


    <script th:replace="_fragment :: allpath"></script>
    <script th:inline="javascript">
        let white=/^\s+$/;
        let left=[[${project.total}]]-[[${project.now}]];
        let num=/^[1-9][0-9]*$/;
        $('#endow').click(function () {
            let amount=$('#amount').val();
            if(white.test(amount)||amount>left||!num.test(amount)){
                alert("请正确输入信息")
            }else {
                $('#no').val(orderCode());  //生成订单号
                $('#form-endow').submit();
            }
        });

        function orderCode() {
            let orderCode='';
            for (let i = 0; i < 6; i++) //6位随机数，用以加在时间戳后面。
            {
                orderCode += Math.floor(Math.random() * 10);
            }
            orderCode = new Date().getTime() + orderCode;  //时间戳，用来生成订单号。
            console.log(orderCode);
            return orderCode;
        }
    </script>


    <footer th:replace="_fragment :: footer">
        <div id="foot" style="margin-top: 50px; background-color: rgb(41, 41, 41); color: #ccc;">
            <div class="container">
                <div class="col-md-6" style="padding: 15px 15px;">
                    <h3>公益</h3>  
                    <p>COPYRIGHT (©) 2019 环保公益平台. 粤ICP备15109341号</p>
                  </div>
                  <div class="col-md-6" style="padding-top: 35px;">
                      <h3>关于我们</h3>
                      <p></p>
                  </div>
            </div>
        </div>
    </footer>
</body>
<script>
    var testEditor;
    $(function () {
        testEditor = editormd.markdownToHTML("test-editormd", {
            htmlDecode :"style, script, iframe",
            emoji           : true,
            taskList        : true,
            tex             : true,  // 默认不解析
            flowChart       : true,  // 默认不解析
            sequenceDiagram : true,  // 默认不解析
        });
    })

</script>
</html>